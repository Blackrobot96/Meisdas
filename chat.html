<!DOCTYPE html>
<html>
<head>
<style>
     * {
        margin: 0;
        box-sizing: border-box;
    }

    body {
            background: #EEE;
            font-family: 'Archivo', sans-serif;
            color: #000;
    }

    .column{
        display: flex;
        flex-direction: column;
        justify-content: space-around;
    }

    .row{
        display: flex;
        flex-direction: row;
        justify-content: space-around;
    }

    .space-row{
        display: flex;
        flex-flow: row wrap;
        justify-content: space-evenly;
    }

    .center-row{
        display: flex;
        flex-flow: row wrap;
        align-items: center;
        justify-content: center;
        padding-top: 5pt;
    }

    .start-row{
        display: flex;
        flex-flow: row wrap;
        align-items: center;
        padding-top: 15pt;
        padding-bottom: 15pt;
    }

    .header{
        background-color: #00519E;
        color: #fff;
        font-size: 24pt;
        margin: 0pt;
        padding: 15pt 5pt;
        font-family:"Calibri";
    }

    .input{
        color: black;
        font-size: 14pt;
        width: 100%;
        font-family:"Calibri";
    }

    .plain-text{
        color: black;
        font-size: 24pt;
        font-family:"Calibri";
        text-align: center;
        width: fit-content;
        border-radius:5px;
        padding: 5px;
    }

    .settings-text{
        color: black;
        font-size: 24pt;
        font-family:"Calibri";
    }

    .input{
        height: 20px;
        margin: 0pt 20pt;
        align-self: center;
    }

    .groupname {
        font-size: 20pt;
        font-weight: bold;
        font-family: "Calibri";
        padding: 10pt;
        border: 3px solid #00519E;
        flex-grow: 2;
    }

    .button {
        font-size: 24pt;
        border: 2px solid #00519E;
        padding-left: 10pt;
        padding-right: 10pt;
        margin-right: 15pt;
        width: 50pt;
    }

    .textarea{
        font-family:"Calibri";
        height: 300px;
        width: 400px;
        font-size:12pt;
    }

    .footer{
        display: flex;
        position: fixed;
        left: 0;
        bottom: 0;
        height: 6%;
        width: 100%;
        background-color: #00519E;
        color: white;
        align-content: center;
    }

    .help-button{
        align-self: center;
        font-size: 16pt;
        border-radius: 5px;
        cursor: pointer;
        padding: 5px;
    }

    .modal{
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        opacity: 0;
        visibility: hidden;
        overflow: auto;
        transition: visibility 0s linear 0.25s, opacity 0.25s 0s, transform 0.25s;
    }

    .modal-content{
        margin: 15% auto;
        padding: 20px;
        width: 80%;
        border: 1px solid #888;
        background-color: white;
        border-radius: 15px;
        color: black;
    }

    .close{
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    .show-modal {
        opacity: 1;
        visibility: visible;
        transform: scale(1.0);
        transition: visibility 0s linear 0s, opacity 0.25s 0s, transform 0.25s;
    }

    .icons {
            line-height: 15pt;
            font-family: 'Material Icons';
            text-align: center;
            font-weight: normal;
            font-style: normal;
            font-size: 12pt;
            display: inline-block;
            text-transform: none;
            letter-spacing: normal;
            word-wrap: normal;
            white-space: nowrap;
            direction: ltr;
            user-select: none;
            /* Support for all WebKit browsers. */
            -webkit-font-smoothing: antialiased;
            /* Support for Safari and Chrome. */
            text-rendering: optimizeLegibility;

            /* Support for Firefox. */
            -moz-osx-font-smoothing: grayscale;

            /* Support for IE. */
            font-feature-settings: 'liga';
            padding-left: 10px;
        }

    

</style>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <div class="column">
        <h1 class="header">Groepenzoeker</h1>
        <div class="row">
            <div class="column" style="border: 1px solid #000; width: 33.3%; align-items: center; height: 70px;" onclick="location.href='profile.html';">
                <p class="plain-text" style="font-weight: bold;">My Profile</p>
            </div>
            <div class="column" style="border: 1px solid #000; width: 33.3%; align-items: center; height: 70px;" onclick="location.href='finder.html';">
                <p class="plain-text" style="font-weight: bold;">Finder</p>
            </div>
            <div class="column" style="border: 1px solid #000; width: 33.3%; align-items: center; height: 70px;" onclick="location.href='groups.html';">
                <p class="plain-text" style="font-weight: bold; background-color: #14AD54;">My Groups</p>
            </div>
        </div>
        <div class="start-row">
            <div class="button" onclick="location.href='groups.html';">&#8592</div>
            <div id="title" class="groupname">
            </div>
            <button class="button" style="width: 105px; font-size:15pt; position: absolute; right: 20px;" onclick="openSettings()">Settings</button>
            <button class="button" style="width: 150px; font-size:15pt; position: absolute; right: 140px;" onclick="leaveGroup()">Leave Group</button>
        </div>
        <div class="row">            
            <div class="textarea" id="textarea" contenteditable="false">
                P1: Hi!<br/> 
                P2: Hello guys<br/>
                P3: When is our next meeting?<br/>
                P1: Tomorrow...<br/>
                P3: Chill, I just asked<br/>
                <span id="chat" style="color: #2ECCFA; float: right; text-align: right;"></span>
             </div>
        </div>
        <div class="center-row">
            <input id="input" style="width:375px">
            <button onclick="send()">&#10148</button>
        </div>
    </div>
    <div class="footer" style="justify-content: center;">
        <button class="help-button">Help</button>
        <div class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <p class="settings-text" style="font-size: 18pt">
                    <span style="font-weight: bold">Group chat helpdesk:</span>
                    <br>This the the group chat. Here you can keep in contact with other group members and also keep track of the settings of a group.
                    <br><span style="font-weight: bold">Sending and unsending a message:</span>
                    <br>To send a message type whatever you would like to add to the conversation in the chatbox and click the send button marked with an arrow next to the chatbox.
                    <br>If you want to unsend a message click the cross symbol next to the message you would like to unsend. 
                    <br><span style="font-weight: bold">Accessing the settings:</span>
                    <br>To access the settings of a group click the "Settings" button in the top right corner of the screen.
                    <br><span style="font-weight: bold">Leaving a group:</span>
                    <br>To leave a group click the "Leave Group" button next to the settings button in the top right.
                </p>
            </div>
        </div>
    </div>
</body>
</html>

<script>
    title = document.getElementById('title');
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    titleText = urlParams.get('Title');
    title.innerHTML = titleText;

    function leaveGroup() {
        var currentValue = JSON.parse(localStorage.getItem("HCIGroups"));
        if (!currentValue)
            currentValue = [];
        var contains = false;
        var newValue = [];
        for (key in currentValue)
        {
            if (currentValue[key] !== titleText)
                newValue.push(currentValue[key])
        }
        localStorage.setItem("HCIGroups", JSON.stringify(newValue));
        window.location.href = "groups.html";
    }

    function openSettings() {
        location.href='settings.html?Title=' + titleText;
    }
    messages = [];

    function renderMessages() {
        var text = "";
        for (key in messages) {
            text += "<div style=\"display: flex\">You: " + messages[key] + "<i class=\"icons\" onclick=\"unsend('" + key +"')\">close</i></div>";
        }
        document.getElementById("chat").innerHTML = text;
    }

    function send(){
        messages.push(document.getElementById("input").value);
        document.getElementById("input").value = "";
        renderMessages();
    }

    function unsend(delKey)
    {
        var newMessages = [];
        for (key in messages) {
            if (key === delKey)
                continue;
            newMessages.push(messages[key]);
        }
        messages = newMessages;
        renderMessages();
    }
    
    function toggleModal() {
        document.querySelector(".modal").classList.toggle("show-modal");
    }

    function windowOnClick(event) {
        if (event.target === modal) {
            toggleModal();
        }
    }

    document.querySelector(".help-button").addEventListener("click", toggleModal);
    document.querySelector(".close").addEventListener("click", toggleModal);
    window.addEventListener("click", windowOnClick);

</script>
